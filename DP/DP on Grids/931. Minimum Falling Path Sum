class Solution {
public:
    int solve(vector<vector<int>>& matrix, int n, int i, int j){

        if(j < 0 || j >= n) return 1e9;
        if(i == 0) return matrix[i][j];

        int ans;
        int left = matrix[i][j] + solve(matrix, n, i - 1, j - 1);
        int middle = matrix[i][j] + solve(matrix, n, i - 1, j);
        int right = matrix[i][j] + solve(matrix, n, i - 1, j + 1);

        ans = min({left, middle, right});

        return ans;

    }

    int solveMem(vector<vector<int>>& matrix, int n, int i, int j, vector<vector<int>>& dp){

        if(j < 0 || j >= n) return 1e9;
        if(i == 0) return matrix[i][j];
        if(dp[i][j] != -1) return dp[i][j];

        int ans;
        int left = matrix[i][j] + solveMem(matrix, n, i - 1, j - 1, dp);
        int middle = matrix[i][j] + solveMem(matrix, n, i - 1, j, dp);
        int right = matrix[i][j] + solveMem(matrix, n, i - 1, j + 1, dp);

        ans = min({left, middle, right});

        return dp[i][j] = ans;

    }

    int solveTab(vector<vector<int>>& matrix, int n){

        vector<vector<int>> dp(n, vector<int>(n, -1));

        for(int i = 0; i < n; i++){
            dp[0][i] = matrix[0][i];
        }

        for(int i = 1; i < n; i++){
            for(int j = 0; j < n; j++){

                int left = matrix[i][j] + ((j - 1 < 0) ? 1e9 : dp[i - 1][j - 1]);
                int middle = matrix[i][j] + dp[i - 1][j];
                int right = matrix[i][j] + ((j + 1 >= n) ? 1e9 : dp[i - 1][j + 1]);

                dp[i][j] = min({left, middle, right});

            }
        }

        int minSum = *min_element(dp[n - 1].begin(), dp[n - 1].end());
        return minSum;

    }

    int solveSO(vector<vector<int>>& matrix, int n){

        vector<int> top(n, 0);

        for(int i = 0; i < n; i++){
            top[i] = matrix[0][i];
        }

        for(int i = 1; i < n; i++){

            vector<int> temp(n, 0);

            for(int j = 0; j < n; j++){

                int left = matrix[i][j] + ((j - 1 < 0) ? 1e9 : top[j - 1]);
                int middle = matrix[i][j] + top[j];
                int right = matrix[i][j] + ((j + 1 >= n) ? 1e9 : top[j + 1]);

                temp[j] = min({left, middle, right});

            }

            top = temp;
        }

        int minSum = *min_element(top.begin(), top.end());
        return minSum;

    }

    int minFallingPathSum(vector<vector<int>>& matrix) {

        int ans = 1e9;
        int n = matrix.size();

        //vector<vector<int>> dp(n, vector<int>(n, -1));

        // for(int i = 0; i < n; i++){
        //     ans = min(ans, solve(matrix, n, n - 1, i));
        //     ans = min(ans, solveMem(matrix, n, n - 1, i, dp));
        // }

        //ans = solveTab(matrix, n);
        
        ans = solveSO(matrix, n);
        return ans;
    }
};
