class Solution {
public:
    int solve(vector<int>& prices, int index, int buy){
        if(index == prices.size()) return 0;

        int ans = 0;

        if(buy == 1){
            ans = max(solve(prices, index + 1, 1), -prices[index] + solve(prices, index + 1, 0));
        }else{
            ans = max(prices[index] + solve(prices, index + 1, 1), solve(prices, index + 1, 0));
        }

        return ans;
    }

    int solveMem(vector<int>& prices, int index, int buy, vector<vector<int>>& dp){
        
        if(index == prices.size()) return 0;

        if(dp[index][buy] != -1) return dp[index][buy];

        int ans = 0;

        if(buy == 1){
            ans = max(solveMem(prices, index + 1, 1, dp), -prices[index] + solveMem(prices, index + 1, 0, dp));
        }else{
            ans = max(prices[index] + solveMem(prices, index + 1, 1, dp), solveMem(prices, index + 1, 0, dp));
        }

        return dp[index][buy] = ans;

    }

    int solveTab(vector<int>& prices){

        int n = prices.size();
        vector<vector<int>> dp(n + 1, vector<int>(2, -1));
        dp[n][0] = dp[n][1] = 0;

        for(int i = n - 1; i >= 0; i--){
            for(int j = 0; j < 2; j++){

                int ans = 0;

                if(j == 1){
                    ans = max(dp[i + 1][1], -prices[i] + dp[i + 1][0]);
                }else{
                    ans = max(prices[i] + dp[i + 1][1], dp[i + 1][0]);
                }

                dp[i][j] = ans;
            }
        }

        return dp[0][1];
    }

    int solveSO(vector<int>& prices){

        int n = prices.size();
        vector<int> dp1(2, -1);
        dp1[0] = dp1[1] = 0;

        for(int i = n - 1; i >= 0; i--){

            vector<int> dp(2, -1);

            for(int j = 0; j < 2; j++){

                int ans = 0;

                if(j == 1){
                    ans = max(dp1[1], -prices[i] + dp1[0]);
                }else{
                    ans = max(prices[i] + dp1[1], dp1[0]);
                }

                dp[j] = ans;
            }
            dp1 = dp;
        }

        return dp1[1];
    }

    int maxProfit(vector<int>& prices) {
        // int ans = solve(prices, 0, 1);

        // int n = prices.size();
        // vector<vector<int>> dp(n, vector<int>(2, -1));
        // int ans = solveMem(prices, 0, 1, dp);

        //int ans = solveTab(prices);
        int ans = solveSO(prices);
        return ans;
    }
};
